import{r as m,j as e}from"./index-CY4b-Uhz.js";import{a as h,c as R}from"./index.esm-CM23mhlL.js";import{C as Z}from"./ChannelProducts-BBDPIzY8.js";import{C as _}from"./CForm-DnU2r5ci.js";import{a as r,C as T}from"./CRow-DK-07wQL.js";import{a as x,C as p,b as y}from"./CFormInput-Bk-u75Sh.js";import{C as F}from"./CFormCheck-OXOhj6rB.js";import{C as w,a as A,b as f,c as o,d as B,e as n}from"./CTable-hn-2QSH7.js";import{C as J,a as O,b as $,c as q}from"./CModalTitle-D0iwjtnT.js";import{C as G}from"./CModalFooter-B4H23WNI.js";import"./Api-BxWCt5AG.js";import"./DefaultLayout-CO0Hj2h9.js";import"./cil-user-Ddrdy7PS.js";var K=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M96,472a23.82,23.82,0,0,0,23.579,24H392.421A23.82,23.82,0,0,0,416,472V152H96Zm32-288H384V464H128Z' class='ci-primary'/><rect width='32' height='200' x='168' y='216' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='200' x='240' y='216' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='200' x='312' y='216' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M328,88V40c0-13.458-9.488-24-21.6-24H205.6C193.488,16,184,26.542,184,40V88H64v32H448V88ZM216,48h80V88H216Z' class='ci-primary'/>"];const ce=()=>{const[g,I]=m.useState(""),[c,d]=m.useState([]),[H,L]=m.useState(!1),[v,C]=m.useState(!1),[u,k]=m.useState("joytel"),E=l=>{console.log("handleGetSelectedItems value="+JSON.stringify(l)),I(l)},b=l=>{k(l.target.value),d([]),console.log("handleSelectChannel value="+l.target.value)},M=()=>{let l=g;console.log("handelSendItems value="+JSON.stringify(g)),d(l),C(!1)},z=(l,s)=>{console.log("handelDelCartItem itemCode="+s);let a=c;a=a.reduce((i,t)=>(t.itemCode!==s&&i.push(t),i),[]),d(a)},D=(l,s)=>{const a=parseInt(s,10)||0;d(i=>i.map(t=>t.itemCode===l?{...t,itemQuantity:a,emailList:Array.from({length:a},(V,j)=>t.emailList[j]||"")}:t))},S=l=>l.itemPrice*l.itemQuantity,N=()=>c.reduce((l,s)=>l+S(s),0),P=l=>{console.log("handleEmailValueChange value="+JSON.stringify(c)),l.currentTarget.checkValidity()===!1&&(l.preventDefault(),l.stopPropagation()),L(!0)},Q=(l,s,a)=>{console.log("handleEmailValueChange id="+l),console.log("handleEmailValueChange value="+a),d(i=>i.map(t=>t.itemCode===l?{...t,emailList:t.emailList.map((V,j)=>j===s?a:V)}:t))};return e.jsxs(_,{className:"row g-3 needs-validation",noValidate:!0,validated:H,onSubmit:P,children:[e.jsxs(r,{md:6,className:"position-relative",children:[e.jsx(x,{htmlFor:"username",children:"客戶姓名"}),e.jsx(p,{type:"text",id:"username",defaultValue:"",required:!0}),e.jsx(y,{invalid:!0,children:"請輸入客戶姓名"})]}),e.jsxs(r,{md:6,className:"position-relative",children:[e.jsx(x,{htmlFor:"cellphone",children:"聯絡電話"}),e.jsx(p,{type:"text",id:"cellphone",defaultValue:"",required:!0}),e.jsx(y,{invalid:!0,children:"請輸入聯絡電話"})]}),e.jsxs(r,{md:12,className:"position-relative",children:[e.jsx(x,{htmlFor:"note",children:"備註"}),e.jsx(p,{type:"text",id:"note",defaultValue:""}),e.jsx(y,{invalid:!0,children:"請輸入備註"})]}),e.jsxs(r,{md:12,className:"position-relative",children:[e.jsx(x,{htmlFor:"channelType",children:"渠道類型    "}),e.jsx(F,{inline:!0,type:"radio",value:"joytel",name:"channelType",id:"fchannelType1",label:"渠道1",checked:u==="joytel",onChange:b}),e.jsx(F,{inline:!0,type:"radio",value:"tgt",name:"channelType",id:"fchannelType2",label:"渠道2",checked:u==="tgt",onChange:b})]}),e.jsx(r,{md:12,children:e.jsxs(x,{htmlFor:"validationDefault05",children:["商品列表    ",e.jsx(h,{color:"info",size:"sm",onClick:()=>C(!v),children:"新增商品"})]})}),e.jsx(r,{md:12,children:e.jsxs(w,{children:[e.jsx(A,{color:"secondary",children:e.jsxs(f,{children:[e.jsx(o,{scope:"col",className:"text-nowrap",children:"商品名稱"}),e.jsx(o,{scope:"col",className:"text-nowrap",children:"單價"}),e.jsx(o,{scope:"col",className:"text-nowrap",children:"激活日期"}),e.jsx(o,{scope:"col",className:"text-nowrap",children:"數量"}),e.jsx(o,{scope:"col",className:"text-nowrap",children:"總價"}),e.jsx(o,{scope:"col",className:"text-nowrap",children:"操作"})]})}),e.jsx(B,{children:c.map((l,s)=>e.jsxs(e.Fragment,{children:[e.jsxs(f,{id:l.itemCode,children:[e.jsx(n,{children:l.itemName}),e.jsx(n,{children:l.itemPrice}),e.jsx(n,{children:l.itemDate}),e.jsx(n,{children:e.jsx(p,{type:"number",size:"sm",max:10,min:1,value:l.itemQuantity,onChange:a=>D(l.itemCode,parseInt(a.target.value,10))})}),e.jsx(n,{children:S(l).toFixed(2)}),e.jsx(n,{children:e.jsx(h,{color:"danger",size:"sm",onClick:a=>z(a,l.itemCode),children:e.jsx(R,{icon:K,size:"sm"})})})]},`item_${s}`),l.emailList.map((a,i)=>e.jsx(f,{children:e.jsx(n,{colSpan:6,children:e.jsxs(T,{children:[e.jsxs(r,{sm:1,children:["第",i+1,"組："]}),e.jsx(r,{sm:4,children:e.jsx(p,{type:"text",defaultValue:a,placeholder:"請輸入要發送QRCode的Email",size:"sm",onChange:t=>Q(l.itemCode,i,t.target.value)})})]})})},`email_${l.itemCode}_${i}`))]}))})]})}),e.jsxs(T,{className:"my-2 text-end",children:[e.jsxs(r,{children:["商品總價：",N().toFixed(2),"元"]}),e.jsxs(r,{children:["應結算金額：",N().toFixed(2),"元"]})]}),e.jsx(r,{xs:12,className:"mb-5",children:e.jsx(h,{color:"primary",type:"submit",className:"float-end",children:"送出"})}),e.jsxs(J,{scrollable:!0,size:"xl",alignment:"center",visible:v,onClose:()=>C(!1),"aria-labelledby":"ScrollingLongContentExampleLabel",children:[e.jsx(O,{children:e.jsx($,{id:"ScrollingLongContentExampleLabel",children:"商品列表"})}),e.jsx(q,{children:e.jsx(Z,{channelName:u,isSelect:!0,onSelectedItem:E,cartItems:c})}),e.jsxs(G,{children:[e.jsx(h,{color:"secondary",onClick:()=>C(!1),children:"取消"}),e.jsx(h,{color:"primary",onClick:M,children:"確認"})]})]})]})};export{ce as default};
